{% extends 'clinic/base.html' %}
{% block content %}
<div class="container py-4">
    <h2>üí∞ Receitas</h2>
    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modalReceita">
        + Nova Receita
    </button>

    <table class="table table-striped">
        <thead>
            <tr>
                <th>Descri√ß√£o</th>
                <th>Valor</th>
                <th>Data</th>
                <th>Pago</th>
                <th>A√ß√µes</th>
            </tr>
        </thead>
        <tbody>
            {% for r in receitas %}
            <tr>
                <td>{{ r.descricao }}</td>
                <td>R$ {{ r.valor }}</td>
                <td>{{ r.data|date:"d/m/Y" }}</td>
                <td>{% if r.pago %}‚úîÔ∏è{% else %}‚ùå{% endif %}</td>
                <td>
                    <a href="{% url 'clinic:receita_update' r.pk %}" class="btn btn-sm btn-warning">Editar</a>
                    <a href="{% url 'clinic:receita_delete' r.pk %}" class="btn btn-sm btn-danger delete-receita"
                        data-id="{{ r.pk }}">
                        Excluir
                    </a>


                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5" class="text-center">Nenhuma receita registrada</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}

<script>
document.querySelectorAll('.delete-receita').forEach(btn => {
    btn.addEventListener('click', function (e) {
        e.preventDefault();
        const url = this.getAttribute('href');

        Swal.fire({
            title: 'Excluir Receita?',
            text: "Esta a√ß√£o n√£o pode ser desfeita.",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#d33',
            cancelButtonColor: '#3085d6',
            confirmButtonText: 'Sim, excluir',
            cancelButtonText: 'Cancelar'
        }).then((result) => {
            if (result.isConfirmed) {
                window.location.href = url;
            }
        });
    });
});
</script>
